function checkEnvVariable(e){var t,r="%"+e+"%",s=new ActiveXObject("Wscript.Shell"),i=s.ExpandEnvironmentStrings(r);return t=i!==r,[t,i]}function setEnvVariable(e,t,r){var s=new ActiveXObject("Wscript.Shell");void 0===r&&(r="Process"),s.Environment(r).Item(e)=t}function askPass(e,t){function r(e,t){var r=!1,s=!1,i=" Retry, or click 'Cancel' if you wish to quit.",a=["Please enter your "+e,"Please re-enter your "+e],n=["Enter "+e,"Re-enter "+e];if(t){var c=[];c[0]="",c[1]=""}else{var c=[];c[0]=""}var o;for(o=0;o<c.length;o++)if(c[o]=xsh.Dialog.Prompt(a[o],n[o],"",promptSecret),""==c[o])for(;!s;){var l="Your entry was blank."+i,v="Entry Blank",p=xsh.Dialog.MessageBox(l,v,msgBoxRetryCan);switch(p){case 4:r=!1,c[o]=xsh.Dialog.Prompt(a[o],n[o],"",promptSecret),s=""!=c[o];break;case 2:r=!0,s=!0,o=2}if(r)break}return!r&&(t?c:c[0])}function s(e,t){var s=!1,i=!1,a=" Retry, or click 'Cancel' if you wish to quit.";if(t[0]!=t[1])for(;!i;){var n="Your entries do not match."+a,c=e+" mismatch",o=xsh.Dialog.MessageBox(n,c,msgBoxRetryCan);switch(o){case 4:s=!1,t=r(e,askTwice),i=t[0]==t[1];break;case 2:s=!0,i=!0}}else s=!1;var l;return s?(l=!1,passString=void 0):(l=!0,passString=t[0]),[l,passString]}var i,a,n=!1;switch(t){case 1:askTwice=!1;break;case 2:default:askTwice=!0}var c=r(e,askTwice);if(c||(n=!0,i=!0),!n)if(askTwice){var o=s(e,c);o[0]?(a=o[1],i=!1):i=!0}else a=c,i=!1;return[i,a]}function getUserPath(){var e=new ActiveXObject("Wscript.Shell"),t=e.ExpandEnvironmentStrings("%USERPROFILE%");return t}function passFileExists(){var e=getUserPath(),t="\\Documents\\NetSarang\\Xshell\\Scripts",r=e+t+"\\ssh.txt",s=new ActiveXObject("Scripting.FileSystemObject");if(s.FileExists(r))var i=!0;else var i=!1;return[i,r]}function isEncrypted(e){var t=new ActiveXObject("Scripting.FileSystemObject"),r=t.OpenTextFile(e),s=r.ReadAll();r.Close();var i=s.length,a=s.indexOf("=")+1;return a==i}function getPass(){var e,t,r,s=passFileExists(),i=s[1];if(s[0])if(isEncrypted(i)){if(void 0===c){var a="PIN",n=checkEnvVariable(a);if(n[0])var c=n[1];else{var o=askPass(a);o[0]?e=2:c=o[1],setEnvVariable(a,c),n=checkEnvVariable(a),n[0]&&c!=n[1]&&(e=3)}}void 0===e&&(t=readPassFile(i,c))}else t=readPassFile(i);else{var l="Password file: '"+i+"' not found. I'll ask for you password now...",v="Password File Not Found";xsh.Dialog.MessageBox(l,v,msgBoxOK),r="password";var p=askPass(r);p[0]?e=1:(e=void 0,t=p[1])}return void 0==e?t:e}function updatePassFile(e,t,r){var s=new ActiveXObject("Scripting.FileSystemObject"),i=2,a=s.OpenTextFile(e,i),n=CryptoJS.AES.encrypt(t,r);a.Write(""),a.Write(n),a.Close()}function readPassFile(e,t){var r=new ActiveXObject("Scripting.FileSystemObject"),s=r.OpenTextFile(e),i=s.ReadAll();s.Close();var a=i.length,n=i.indexOf("=")+1;return n==a&&(decryptedPass=CryptoJS.AES.decrypt(i,t),i=decryptedPass.toString(CryptoJS.enc.Utf8)),i}